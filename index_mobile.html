<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–ò–Ω–≥–æ—Å—Å—Ç—Ä–∞—Ö - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</title>
  <meta name="description" content="–ò–Ω–≥–æ—Å—Å—Ç—Ä–∞—Ö - –±—ã—Å—Ç—Ä—ã–π —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è">

  <!-- –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <link rel="stylesheet" href="ingosstrax_mobile.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

  <style>
    /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Roboto', Arial, sans-serif;
      background: #f8fafc;
      color: #1a1a1a;
      min-height: 100vh;
      -webkit-tap-highlight-color: transparent;
    }
  </style>
</head>

<body>
  <!-- –®–∞–ø–∫–∞ -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        <div class="logo-icon">üèõÔ∏è</div>
        <div class="logo-text">
          <h1>–ò–Ω–≥–æ—Å—Å—Ç—Ä–∞—Ö</h1>
          <p>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è</p>
        </div>
      </div>
    </div>
  </header>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
  <main class="main">
    <!-- –ë–ª–æ–∫ —Ä–∞—Å—á–µ—Ç–∞ -->
    <section class="calc-section">
      <div class="calc-card">
        <h2 class="section-title">üí∞ –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏</h2>

        <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ -->
        <div class="input-group">
          <label class="input-label">–î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞</label>
          <div class="input-wrapper">
            <textarea
              id="client-input"
              placeholder="–ü—Ä–∏–º–µ—Ä: –í–¢–ë –æ—Å—Ç 3000000 –º—É–∂ 15.08.1985 –∫–≤–∞—Ä—Ç–∏—Ä–∞"
              rows="3"
              maxlength="1000"
            ></textarea>
          </div>
          <div class="input-help">
            <span class="help-icon">üí°</span>
            –£–∫–∞–∂–∏—Ç–µ –±–∞–Ω–∫, –û–°–ó, –¥–∞–Ω–Ω—ã–µ –∑–∞–µ–º—â–∏–∫–∞, —Ç–∏–ø –æ–±—ä–µ–∫—Ç–∞
          </div>
        </div>

        <!-- –ö–Ω–æ–ø–∫–∏ -->
        <div class="button-group">
          <button id="calculate-btn" class="btn-primary">
            <span class="btn-icon">‚ö°</span>
            –†–∞—Å—Å—á–∏—Ç–∞—Ç—å
          </button>
          <button id="clear-btn" class="btn-secondary">
            <span class="btn-icon">üóëÔ∏è</span>
            –û—á–∏—Å—Ç–∏—Ç—å
          </button>
        </div>
      </div>

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
      <div id="results-section" class="results-section" style="display: none;">
        <div class="results-card">
          <h3 class="results-title">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞—Å—á–µ—Ç–∞</h3>
          <div id="results-content" class="results-content"></div>
        </div>
      </div>
    </section>

    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–Ω–∫–∞—Ö -->
    <section class="banks-section">
      <h3 class="section-title-mini">üè¶ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –±–∞–Ω–∫–∏</h3>
      <div class="banks-grid">
        <div class="bank-item">–°–±–µ—Ä–±–∞–Ω–∫</div>
        <div class="bank-item">–í–¢–ë</div>
        <div class="bank-item">–î–æ–º.–†–§</div>
        <div class="bank-item">–ê–ª—å—Ñ–∞ –ë–∞–Ω–∫</div>
        <div class="bank-item">–¢–∏–º–µ—Ä –ë–∞–Ω–∫</div>
        <div class="bank-item">–ú–µ—Ç–∞–ª–ª–∏–Ω–≤–µ—Å—Ç</div>
        <div class="bank-item">–†–æ—Å–±–∞–Ω–∫</div>
        <div class="bank-item">–†–∞–π—Ñ—Ñ–∞–π–∑–µ–Ω</div>
        <div class="bank-item">–ü—Ä–æ–º—Å–≤—è–∑—å–±–∞–Ω–∫</div>
        <div class="bank-item">–ê–∫ –ë–∞—Ä—Å</div>
        <div class="bank-item">–ó–µ–Ω–∏—Ç</div>
        <div class="bank-item">–ò–¢–ë/–¢–ö–ë</div>
        <div class="bank-item">–£–ë–†–ò–†</div>
        <div class="bank-item">–£—Ä–∞–ª—Å–∏–±</div>
        <div class="bank-item">–Æ–Ω–∏–∫—Ä–µ–¥–∏—Ç</div>
        <div class="bank-item">–†–°–•–ë</div>
      </div>
    </section>
  </main>

  <!-- –ü–æ–¥–≤–∞–ª -->
  <footer class="footer">
    <p>&copy; 2025 –ò–Ω–≥–æ—Å—Å—Ç—Ä–∞—Ö. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </footer>

  <script>
    // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
    function initMobileCalculator() {
      const clientInput = document.getElementById('client-input');
      const calculateBtn = document.getElementById('calculate-btn');
      const clearBtn = document.getElementById('clear-btn');
      const resultsSection = document.getElementById('results-section');
      const resultsContent = document.getElementById('results-content');

      // Touch-friendly –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
      calculateBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        this.style.transform = 'scale(0.95)';
      });

      calculateBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        this.style.transform = 'scale(1)';
        calculate();
      });

      clearBtn.addEventListener('touchstart', function(e) {
        e.preventDefault();
        this.style.transform = 'scale(0.95)';
      });

      clearBtn.addEventListener('touchend', function(e) {
        e.preventDefault();
        this.style.transform = 'scale(1)';
        clearData();
      });

      // –ö–ª–∏–∫ –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–æ–≤
      calculateBtn.addEventListener('click', calculate);
      clearBtn.addEventListener('click', clearData);

      // Enter –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
      clientInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter' && !e.shiftKey) {
          e.preventDefault();
          calculate();
        }
      });

      async function calculate() {
        const message = clientInput.value.trim();

        if (!message) {
          showError('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞');
          return;
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ª–∏ —Å–∫—Ä–∏–ø—Ç—ã
        if (typeof handleClientRequest === 'undefined') {
          showError('–°–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á–µ—Ç–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É.');
          return;
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
        calculateBtn.disabled = true;
        calculateBtn.innerHTML = '<span class="loading">‚è≥</span> –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º...';

        try {
          const result = handleClientRequest(message);
          resultsContent.innerHTML = result.replace(/\n/g, '<br>');
          resultsSection.style.display = 'block';

          // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
          setTimeout(() => {
            resultsSection.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
          }, 100);

        } catch (error) {
          console.error('–û—à–∏–±–∫–∞:', error);
          showError('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–≤–µ–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.');
        } finally {
          calculateBtn.disabled = false;
          calculateBtn.innerHTML = '<span class="btn-icon">‚ö°</span> –†–∞—Å—Å—á–∏—Ç–∞—Ç—å';
        }
      }

      function clearData() {
        clientInput.value = '';
        resultsSection.style.display = 'none';
        resultsContent.innerHTML = '';
        clientInput.focus();
      }

      function showError(message) {
        resultsContent.innerHTML = `<div class="error-message">
          <div class="error-icon">‚ùå</div>
          <div class="error-text">${message}</div>
        </div>`;
        resultsSection.style.display = 'block';
      }

      // –§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
      setTimeout(() => {
        clientInput.focus();
      }, 500);
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤
    function checkScriptsLoaded() {
      if (typeof handleClientRequest !== 'undefined' &&
          typeof parseTextToObject !== 'undefined' &&
          typeof performCalculations !== 'undefined') {
        initMobileCalculator();
      } else {
        setTimeout(checkScriptsLoaded, 100);
      }
    }

    // –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ DOM
    document.addEventListener('DOMContentLoaded', function() {
      checkScriptsLoaded();
    });

    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º zoom –Ω–∞ iOS
    document.addEventListener('gesturestart', function(e) {
      e.preventDefault();
    });
  </script>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –ª–æ–≥–∏–∫—É -->
  <script src="config_banks.js"></script>
  <script src="tariffs_life.js"></script>
  <script src="tariffs_property.js"></script>
  <script src="tariffs_ifl.js"></script>
  <script src="parser.js"></script>
  <script src="calculator_v2.js"></script>
  <script src="openai.js"></script>
</body>
</html>
