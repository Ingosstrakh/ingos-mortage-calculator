// openai.js - –ú–æ—â–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Grok —á–µ—Ä–µ–∑ Puter API + —Å—É–ø–µ—Ä-–ø–∞—Ä—Å–µ—Ä

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –º–æ—â–Ω–æ–≥–æ AI
let aiSettings = {
  useGrok: true, // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏ Grok (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ puter.com)
  learningMode: true, // –†–µ–∂–∏–º –æ–±—É—á–µ–Ω–∏—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
  learnedPatterns: {}, // –û–±—É—á–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
  responseHistory: [] // –ò—Å—Ç–æ—Ä–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è
};

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è AI - –ø—Ä–æ–±—É–µ–º Grok, –ø—Ä–∏ –æ—à–∏–±–∫–µ - –º–æ—â–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
async function askGPTNeo(question) {
  // –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Grok —á–µ—Ä–µ–∑ Puter (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω)
  if (aiSettings.useGrok) {
    try {
      const grokResponse = await fetchGrokAPI(question);
      if (grokResponse) {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
        if (aiSettings.learningMode) {
          learnFromResponse(question, grokResponse);
        }
        return grokResponse;
      }
    } catch (error) {
      console.log('Grok –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–Ω—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ puter.com):', error.message);
      console.log('üîó –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –Ω–∞ https://puter.com –¥–ª—è –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–≥–æ AI');
    }
  }

  // Fallback –Ω–∞ –º–æ—â–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π —Å—É–ø–µ—Ä-–ø–∞—Ä—Å–µ—Ä
  return generateSuperSmartResponse(question);
}

// Grok API —á–µ—Ä–µ–∑ Puter (—Ç—Ä–µ–±—É–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞ puter.com)
async function fetchGrokAPI(question) {
  try {
    const response = await puter.ai.chat(question, {
      model: 'x-ai/grok-4.1-fast',
      temperature: 0.7,
      max_tokens: 1000
    });

    console.log('Grok response:', response);
    return response.message.content.trim();
  } catch (error) {
    console.error('Grok API error:', error);
    throw error;
  }
}

// –§—É–Ω–∫—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è –æ—Ç —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ Grok
function learnFromResponse(question, response) {
  const questionKey = question.toLowerCase().trim();

  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–ª—è –±—É–¥—É—â–∏—Ö —É–ª—É—á—à–µ–Ω–∏–π
  if (!aiSettings.learnedPatterns[questionKey]) {
    aiSettings.learnedPatterns[questionKey] = {
      response: response,
      timestamp: Date.now(),
      usage: 1
    };
  } else {
    aiSettings.learnedPatterns[questionKey].usage++;
  }

  // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã –æ–±—É—á–µ–Ω–∏—è
  if (Object.keys(aiSettings.learnedPatterns).length > 100) {
    // –£–¥–∞–ª—è–µ–º —Å–∞–º—ã–µ —Å—Ç–∞—Ä—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
    const sorted = Object.entries(aiSettings.learnedPatterns)
      .sort((a, b) => a[1].timestamp - b[1].timestamp);
    delete aiSettings.learnedPatterns[sorted[0][0]];
  }
}

// –°—É–ø–µ—Ä-—É–º–Ω—ã–π –ª–æ–∫–∞–ª—å–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å –æ–±—É—á–µ–Ω–∏–µ–º
function generateSuperSmartResponse(question) {
  const q = question.toLowerCase().trim();

  // 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ–±—É—á–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
  if (aiSettings.learningMode && aiSettings.learnedPatterns[q]) {
    aiSettings.learnedPatterns[q].usage++;
    return `üß† **–ò–∑ –æ–±—É—á–µ–Ω–Ω–æ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π:**\n\n${aiSettings.learnedPatterns[q].response}`;
  }

  // 2. –†–∞—Å—á–µ—Ç—ã - –ø—Ä–æ–±—É–µ–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ
  const calcResult = tryCalculateLocally(question);
  if (calcResult) {
    return calcResult;
  }

  // 3. –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑ –≤–æ–ø—Ä–æ—Å–∞
  const analysis = analyzeQuestion(question);

  // 4. –£–º–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞
  if (analysis.intent === 'documents') {
    return generateDocumentsResponse(analysis);
  }

  if (analysis.intent === 'discounts') {
    return generateDiscountsResponse(analysis);
  }

  if (analysis.intent === 'comparison') {
    return generateComparisonResponse(analysis);
  }

  if (analysis.intent === 'emergency') {
    return generateEmergencyResponse(analysis);
  }

  if (analysis.intent === 'renewal') {
    return generateRenewalResponse(analysis);
  }

  if (analysis.intent === 'general') {
    return generateGeneralResponse(analysis);
  }

  // 5. –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–¥–æ—à–ª–æ - —É–º–Ω—ã–π fallback
  return generateSmartFallback(question, analysis);
}

// –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤
function analyzeQuestion(question) {
  const q = question.toLowerCase();

  const analysis = {
    intent: 'unknown',
    entities: [],
    keywords: [],
    complexity: 'simple'
  };

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –Ω–∞–º–µ—Ä–µ–Ω–∏–µ
  if (/\b(–¥–æ–∫—É–º–µ–Ω—Ç|–Ω—É–∂–µ–Ω|—Ç—Ä–µ–±—É–µ—Ç—Å—è|–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å)\b/.test(q)) {
    analysis.intent = 'documents';
  } else if (/\b(—Å–∫–∏–¥–∫|—ç–∫–æ–Ω–æ–º|–¥–µ—à–µ–≤–ª–µ|–≤—ã–≥–æ–¥–Ω)\b/.test(q)) {
    analysis.intent = 'discounts';
  } else if (/\b(—Ä–∞–∑–Ω–∏—Ü|–æ—Ç–ª–∏—á–∞|—Å—Ä–∞–≤–Ω–∏|–ø—Ä–æ—Ç–∏–≤|–ª—É—á—à–µ)\b/.test(q)) {
    analysis.intent = 'comparison';
  } else if (/\b(—Å–ª—É—á–∞–π|–ø—Ä–æ–∏–∑–æ—à–µ–ª|–ø–æ–≤—Ä–µ–¥–∏–ª|–∑–∞–±–æ–ª–µ–ª|—Å–ª–æ–º–∞–ª)\b/.test(q)) {
    analysis.intent = 'emergency';
  } else if (/\b(–ø—Ä–æ–¥–ª|–ø—Ä–æ–¥–ª–µ–Ω–∏–µ|–æ–±–Ω–æ–≤–∏—Ç—å|–ø—Ä–æ–¥–ª–∏—Ç—å)\b/.test(q)) {
    analysis.intent = 'renewal';
  } else if (/\b(–∏–ø–æ—Ç–µ–∫|–∫—Ä–µ–¥–∏—Ç|—Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ|–∑–∞—â–∏—Ç)\b/.test(q)) {
    analysis.intent = 'general';
  }

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å—É—â–Ω–æ—Å—Ç–∏ (–±–∞–Ω–∫–∏, —Ä–∏—Å–∫–∏ –∏ —Ç.–¥.)
  if (/\b(—Å–±–µ—Ä|—Å–±–µ—Ä–±–∞–Ω–∫)\b/.test(q)) analysis.entities.push('sberbank');
  if (/\b(–≤—Ç–±)\b/.test(q)) analysis.entities.push('vtb');
  if (/\b(–∂–∏–∑–Ω—å|–∑–¥–æ—Ä–æ–≤—å–µ)\b/.test(q)) analysis.entities.push('life');
  if (/\b(–∏–º—É—â–µ—Å—Ç–≤|–∫–≤–∞—Ä—Ç–∏—Ä|–¥–æ–º)\b/.test(q)) analysis.entities.push('property');
  if (/\b(—Ç–∏—Ç—É–ª|–ø—Ä–∞–≤–æ)\b/.test(q)) analysis.entities.push('title');

  // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å
  const words = q.split(' ').length;
  if (words > 10) analysis.complexity = 'complex';
  else if (words > 5) analysis.complexity = 'medium';

  return analysis;
}

// –£–º–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞
function generateDocumentsResponse(analysis) {
  let response = `üìÑ **–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è**\n\n`;

  if (analysis.entities.includes('life')) {
    response += `**–î–ª—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è –∂–∏–∑–Ω–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**\n`;
    response += `‚Ä¢ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ (—Ñ–æ—Ä–º–∞ 086/—É)\n`;
    response += `‚Ä¢ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–æ–≤ (–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é)\n`;
    response += `‚Ä¢ –°–ø—Ä–∞–≤–∫–∞ –æ—Ç –ø—Å–∏—Ö–∏–∞—Ç—Ä–∞ –∏ –Ω–∞—Ä–∫–æ–ª–æ–≥–∞\n\n`;
  }

  if (analysis.entities.includes('property')) {
    response += `**–î–ª—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è –∏–º—É—â–µ—Å—Ç–≤–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**\n`;
    response += `‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç –æ–±—ä–µ–∫—Ç–∞\n`;
    response += `‚Ä¢ –í—ã–ø–∏—Å–∫–∞ –∏–∑ –ï–ì–†–ù\n`;
    response += `‚Ä¢ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –æ–±—ä–µ–∫—Ç–∞\n\n`;
  }

  response += `**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**\n`;
  response += `‚Ä¢ –ü–∞—Å–ø–æ—Ä—Ç –∑–∞–µ–º—â–∏–∫–∞/—Å–æ–∑–∞–µ–º—â–∏–∫–æ–≤\n`;
  response += `‚Ä¢ –°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ –±—Ä–∞–∫–µ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏)\n`;
  response += `‚Ä¢ –°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏ –¥–µ—Ç–µ–π\n`;
  response += `‚Ä¢ –ö—Ä–µ–¥–∏—Ç–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä\n\n`;

  response += `**–í–∞–∂–Ω–æ:** –ü–µ—Ä–µ—á–µ–Ω—å –º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –±–∞–Ω–∫–∞ –∏ —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏.`;

  return response;
}

function generateDiscountsResponse(analysis) {
  let response = `üí∞ **–°–∫–∏–¥–∫–∏ –Ω–∞ –∏–ø–æ—Ç–µ—á–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ**\n\n`;

  response += `**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Å–∫–∏–¥–∫–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç:**\n`;
  response += `‚Ä¢ **–°–±–µ—Ä–±–∞–Ω–∫:** 25% –Ω–∞ –∂–∏–∑–Ω—å, 10% –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ\n`;
  response += `‚Ä¢ **–í–¢–ë:** 25% –Ω–∞ –∂–∏–∑–Ω—å, 10% –Ω–∞ –∏–º—É—â–µ—Å—Ç–≤–æ\n`;
  response += `‚Ä¢ **–î—Ä—É–≥–∏–µ –±–∞–Ω–∫–∏:** –æ–±—ã—á–Ω–æ 10-15% –Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å\n\n`;

  response += `**–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–∫–∏–¥–∫—É:**\n`;
  response += `1. üè¶ –í—ã–±—Ä–∞—Ç—å –±–∞–Ω–∫ —Å–æ —Å–∫–∏–¥–∫–∞–º–∏\n`;
  response += `2. üì¶ –û—Ñ–æ—Ä–º–∏—Ç—å –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ\n`;
  response += `3. ‚è∞ –°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞\n`;
  response += `4. üõ°Ô∏è –ë–µ–∑—É–±—ã—Ç–æ—á–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è\n\n`;

  response += `**–ü—Ä–∏–º–µ—Ä —ç–∫–æ–Ω–æ–º–∏–∏:**\n`;
  response += `–ë–µ–∑ —Å–∫–∏–¥–æ–∫: 50 000‚ÇΩ\n`;
  response += `–°–æ —Å–∫–∏–¥–∫–∞–º–∏: 37 500‚ÇΩ\n`;
  response += `**–≠–∫–æ–Ω–æ–º–∏—è: 12 500‚ÇΩ (25%)**\n\n`;

  response += `üí° –°–æ–≤–µ—Ç: –°–∫–∏–¥–∫–∏ —Å—É–º–º–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏!`;

  return response;
}

function generateComparisonResponse(analysis) {
  let response = `‚öñÔ∏è **–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∏–¥–æ–≤ –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è**\n\n`;

  if (analysis.entities.includes('life') || analysis.entities.includes('property')) {
    response += `**–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–∏ vs –ò–º—É—â–µ—Å—Ç–≤–∞:**\n\n`;
    response += `üè• **–ñ–∏–∑–Ω—å –∏ –∑–¥–æ—Ä–æ–≤—å–µ:**\n`;
    response += `‚Ä¢ ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ –∑–∞–∫–æ–Ω—É\n`;
    response += `‚Ä¢ üíº –ó–∞—â–∏—â–∞–µ—Ç –¥–æ—Ö–æ–¥ –ø—Ä–∏ –±–æ–ª–µ–∑–Ω–∏\n`;
    response += `‚Ä¢ üìà –¢–∞—Ä–∏—Ñ—ã 0.1-2.5% (–ø–æ –≤–æ–∑—Ä–∞—Å—Ç—É)\n`;
    response += `‚Ä¢ üí∞ –°–∫–∏–¥–∫–∏ –¥–æ 25%\n\n`;

    response += `üè† **–ò–º—É—â–µ—Å—Ç–≤–æ:**\n`;
    response += `‚Ä¢ ‚ö†Ô∏è –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –±–∞–Ω–∫–∞–º–∏\n`;
    response += `‚Ä¢ üèóÔ∏è –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π\n`;
    response += `‚Ä¢ üìä –¢–∞—Ä–∏—Ñ—ã 0.1-0.43% (–ø–æ —Ç–∏–ø—É)\n`;
    response += `‚Ä¢ üí∞ –°–∫–∏–¥–∫–∏ –¥–æ 10%\n\n`;
  }

  response += `**–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≤—ã–≥–æ–¥–Ω–µ–µ:**\n`;
  response += `‚Ä¢ üì¶ –û–¥–∏–Ω –ø–æ–ª–∏—Å –Ω–∞ –≤—Å–µ —Ä–∏—Å–∫–∏\n`;
  response += `‚Ä¢ üí∏ –≠–∫–æ–Ω–æ–º–∏—è –¥–æ 30%\n`;
  response += `‚Ä¢ üõ°Ô∏è –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞\n\n`;

  response += `üéØ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–±–∏—Ä–∞–π—Ç–µ –∫–æ–º–ø–ª–µ–∫—Å - –Ω–∞–¥–µ–∂–Ω–µ–µ –∏ –¥–µ—à–µ–≤–ª–µ!`;

  return response;
}

function generateEmergencyResponse(analysis) {
  let response = `üö® **–î–µ–π—Å—Ç–≤–∏—è –ø—Ä–∏ —Å—Ç—Ä–∞—Ö–æ–≤–æ–º —Å–ª—É—á–∞–µ**\n\n`;

  response += `**–ù–ï–ú–ï–î–õ–ï–ù–ù–û:**\n`;
  response += `1. üìû –ü–æ–∑–≤–æ–Ω–∏—Ç–µ –≤ —Å—Ç—Ä–∞—Ö–æ–≤—É—é –∫–æ–º–ø–∞–Ω–∏—é\n`;
  response += `2. üì∏ –°—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—Ä—É–π—Ç–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è\n`;
  response += `3. üõë –ù–µ –ø—Ä–æ–≤–æ–¥–∏—Ç–µ —Ä–µ–º–æ–Ω—Ç\n\n`;

  if (analysis.entities.includes('life')) {
    response += `**–ü—Ä–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏ –∂–∏–∑–Ω–∏:**\n`;
    response += `‚Ä¢ –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –ª–µ—á–∞—â–µ–º—É –≤—Ä–∞—á—É\n`;
    response += `‚Ä¢ –ü–æ–ª—É—á–∏—Ç–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã\n`;
    response += `‚Ä¢ –°–æ–æ–±—â–∏—Ç–µ –±–∞–Ω–∫—É –æ —Å–∏—Ç—É–∞—Ü–∏–∏\n\n`;
  }

  if (analysis.entities.includes('property')) {
    response += `**–ü—Ä–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏ –∏–º—É—â–µ—Å—Ç–≤–∞:**\n`;
    response += `‚Ä¢ –í—ã–∑–æ–≤–∏—Ç–µ –∞–≤–∞—Ä–∏–π–Ω—É—é —Å–ª—É–∂–±—É\n`;
    response += `‚Ä¢ –û–±–µ—Å–ø–µ—á—å—Ç–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å\n`;
    response += `‚Ä¢ –ó–∞—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ —Ñ–∞–∫—Ç –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è\n\n`;
  }

  response += `**–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –≤—ã–ø–ª–∞—Ç—ã:**\n`;
  response += `‚Ä¢ –ó–∞—è–≤–ª–µ–Ω–∏–µ –≤ —Å—Ç—Ä–∞—Ö–æ–≤—É—é\n`;
  response += `‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç—ã, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—â–∏–µ —Ñ–∞–∫—Ç\n`;
  response += `‚Ä¢ –ê–∫—Ç –æ—Å–º–æ—Ç—Ä–∞ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π\n\n`;

  response += `‚è±Ô∏è **–°—Ä–æ–∫–∏:** 20-30 –¥–Ω–µ–π –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ\n\n`;
  response += `üí° **–í–∞–∂–Ω–æ:** –ë–∞–Ω–∫ –ø–æ–ª—É—á–∏—Ç –≤—ã–ø–ª–∞—Ç—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!`;

  return response;
}

function generateRenewalResponse(analysis) {
  let response = `üîÑ **–ü—Ä–æ–¥–ª–µ–Ω–∏–µ –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è**\n\n`;

  response += `**–ö–æ–≥–¥–∞ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å:**\n`;
  response += `‚Ä¢ üìÖ –ó–∞ 30 –¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è\n`;
  response += `‚Ä¢ üéØ –í –¥–∞—Ç—É –≤—ã–¥–∞—á–∏ –∫—Ä–µ–¥–∏—Ç–∞\n\n`;

  response += `**–ß—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è:**\n`;
  response += `‚Ä¢ üìù –ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ\n`;
  response += `‚Ä¢ ‚úÖ –ê–∫—Ç —Å–≤–µ—Ä–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π\n`;
  response += `‚Ä¢ üè• –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)\n\n`;

  response += `**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏—è:**\n`;
  response += `‚Ä¢ üéÅ –°–∫–∏–¥–∫–∏ –∑–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å\n`;
  response += `‚Ä¢ ‚ö° –ë–µ–∑ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –º–µ–¥–æ—Å–º–æ—Ç—Ä–∞\n`;
  response += `‚Ä¢ üí∞ –ë–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è\n\n`;

  response += `**–°—Ç–æ–∏–º–æ—Å—Ç—å:**\n`;
  response += `‚Ä¢ –û–±—ã—á–Ω–æ —Ç–∞–∫–∞—è –∂–µ, –∫–∞–∫ –≤ –ø—Ä–æ—à–ª–æ–º –≥–æ–¥—É\n`;
  response += `‚Ä¢ –ú–æ–∂–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å—Å—è –ø—Ä–∏ —Å–∫–∏–¥–∫–∞—Ö\n\n`;

  response += `üí° **–°–æ–≤–µ—Ç:** –ü—Ä–æ–¥–ª–µ–≤–∞–π—Ç–µ –∑–∞—Ä–∞–Ω–µ–µ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø–µ—Ä–µ—Ä—ã–≤–∞ –≤ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏!`;

  return response;
}

function generateGeneralResponse(analysis) {
  let response = `üè† **–ò–ø–æ—Ç–µ—á–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ - –≤–∞—à –Ω–∞–¥–µ–∂–Ω—ã–π —â–∏—Ç**\n\n`;

  response += `**–ü–æ—á–µ–º—É –æ–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ:**\n`;
  response += `‚Ä¢ üèõÔ∏è –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –¶–ë –†–§\n`;
  response += `‚Ä¢ üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ä–∏—Å–∫–æ–≤\n`;
  response += `‚Ä¢ üíº –£—Å–ª–æ–≤–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—Ä–µ–¥–∏—Ç–∞\n\n`;

  response += `**–ß—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç:**\n`;
  response += `‚Ä¢ üë§ –ñ–∏–∑–Ω—å –∏ –∑–¥–æ—Ä–æ–≤—å–µ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)\n`;
  response += `‚Ä¢ üè° –ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)\n`;
  response += `‚Ä¢ üìã –ü—Ä–∞–≤–æ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (–¥–ª—è –≤—Ç–æ—Ä–∏—á–∫–∏)\n\n`;

  response += `**–°—Ç–æ–∏–º–æ—Å—Ç—å:** 0.5-3% –æ—Ç —Å—É–º–º—ã –∫—Ä–µ–¥–∏—Ç–∞ –µ–∂–µ–≥–æ–¥–Ω–æ\n\n`;

  if (analysis.complexity === 'simple') {
    response += `üí¨ **–ß–µ–º —è –º–æ–≥—É –ø–æ–º–æ—á—å?**\n`;
    response += `‚Ä¢ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å\n`;
    response += `‚Ä¢ –ü–æ–¥–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç\n`;
    response += `‚Ä¢ –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã\n\n`;
    response += `–ü–æ–ø—Ä–æ–±—É–π—Ç–µ: "–°–±–µ—Ä–±–∞–Ω–∫ –æ—Å–∑ 3000000 –º—É–∂ 15.08.1985 –∫–≤–∞—Ä—Ç–∏—Ä–∞"`;
  }

  return response;
}

// –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ–± –ò–ò –∏ –æ–±—É—á–µ–Ω–∏–∏
if (q.includes('–æ–±—É—á–µ–Ω–∏–µ') || q.includes('–æ–±—É—á–∞–µ—Ç—Å—è') || q.includes('—É—á–∏—Ç—Å—è')) {
  return `üéì **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –ò–ò**\n\n` +
         `**–ú–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –æ–±—É—á–µ–Ω–∏—è:**\n` +
         `‚Ä¢ üìö **–ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π** - 50+ –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã—Ö —É–º–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤\n` +
         `‚Ä¢ üß† **Grok AI** - —É—á—É—Å—å –Ω–∞ –∫–∞–∂–¥–æ–º –≤–∞—à–µ–º –≤–æ–ø—Ä–æ—Å–µ —á–µ—Ä–µ–∑ xAI\n` +
         `‚Ä¢ üíæ **–ü–∞–º—è—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤** - –∑–∞–ø–æ–º–∏–Ω–∞—é —É—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã\n` +
         `‚Ä¢ üìà **–°–∞–º–æ—É–ª—É—á—à–µ–Ω–∏–µ** - –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é —á–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã\n\n` +
         `**–ü—Ä–∏–º–µ—Ä—ã –æ–±—É—á–µ–Ω–∏—è:**\n` +
         `‚Ä¢ –ü–µ—Ä–≤—ã–π —Ä–∞–∑: "–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø–æ–∂–∞—Ä–µ?" ‚Üí —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –æ—Ç–≤–µ—Ç\n` +
         `‚Ä¢ –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è: –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã\n\n` +
         `**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ö–∞–∂–¥—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä –¥–µ–ª–∞–µ—Ç –º–µ–Ω—è —É–º–Ω–µ–µ! üöÄ`;
}

if (q.includes('–æ —Å–µ–±–µ') || q.includes('–∫—Ç–æ —Ç—ã') || q.includes('—á—Ç–æ —É–º–µ–µ—à—å')) {
  return `ü§ñ **–û —Å–µ–±–µ - –Ø Grok + –ú–æ—â–Ω—ã–π –ü–∞—Ä—Å–µ—Ä**\n\n` +
         `**–ú–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ:**\n` +
         `‚Ä¢ üß† **Grok AI** - —Å–æ–∑–¥–∞–Ω xAI (–ò–ª–æ–Ω –ú–∞—Å–∫)\n` +
         `‚Ä¢ üéØ **–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è** - –∏–ø–æ—Ç–µ—á–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –†–§\n` +
         `‚Ä¢ üìö **–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ** - 50+ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è\n` +
         `‚Ä¢ üéì **–û–±—É—á–µ–Ω–∏–µ** - —É—á—É—Å—å –Ω–∞ –∫–∞–∂–¥–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏\n\n` +
         `**–ú–æ–∏ –Ω–∞–≤—ã–∫–∏:**\n` +
         `‚Ä¢ üî¢ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —Ä–∞—Å—á–µ—Ç—ã –∏–∑ —Ç–µ–∫—Å—Ç–∞\n` +
         `‚Ä¢ üí¨ –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥ –Ω–∞ —Ä—É—Å—Å–∫–æ–º\n` +
         `‚Ä¢ üìä –ê–Ω–∞–ª–∏–∑ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π\n` +
         `‚Ä¢ üí° –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Å–æ–≤–µ—Ç—ã\n` +
         `‚Ä¢ üö® –ü–æ–º–æ—â—å –≤ —á—Ä–µ–∑–≤—ã—á–∞–π–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö\n\n` +
         `**–î–ª—è –ø–æ–ª–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ Grok:** –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –Ω–∞ puter.com\n\n` +
         `–Ø –∑–¥–µ—Å—å, —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –∏–ø–æ—Ç–µ—á–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º! üè†‚ú®`;
}

function generateSmartFallback(question, analysis) {
  // –£–º–Ω—ã–π fallback —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è–º–∏
  const suggestions = [];

  if (analysis.intent === 'unknown') {
    suggestions.push('üìä –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è');
    suggestions.push('üìÑ –£–∑–Ω–∞—Ç—å –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö');
    suggestions.push('üí∞ –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–∫–∏–¥–∫–∞—Ö');
    suggestions.push('üéì –£–∑–Ω–∞—Ç—å –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ–±—É—á–µ–Ω–∏–µ –ò–ò');
    suggestions.push('ü§ñ –£–∑–Ω–∞—Ç—å –æ –º–æ–∏—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö');
  }

  let response = `ü§î **–Ø –ø–æ—Å—Ç–∞—Ä–∞–ª—Å—è –ø–æ–Ω—è—Ç—å –≤–∞—à –≤–æ–ø—Ä–æ—Å, –Ω–æ –Ω—É–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å.**\n\n`;

  if (suggestions.length > 0) {
    response += `**–í–æ–∑–º–æ–∂–Ω–æ, –≤—ã –∏–º–µ–ª–∏ –≤ –≤–∏–¥—É:**\n`;
    suggestions.forEach(suggestion => {
      response += `‚Ä¢ ${suggestion}\n`;
    });
    response += `\n`;
  }

  response += `**–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–ø—Ä–æ—Å–∏—Ç—å:**\n`;
  response += `‚Ä¢ "–ö–∞–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –Ω—É–∂–Ω—ã –¥–ª—è –∏–ø–æ—Ç–µ–∫–∏?"\n`;
  response += `‚Ä¢ "–í —á–µ–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –≤–∏–¥–∞–º–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è?"\n`;
  response += `‚Ä¢ "–°–±–µ—Ä–±–∞–Ω–∫ –æ—Å–∑ 3000000 –º—É–∂ 15.08.1985 –∫–≤–∞—Ä—Ç–∏—Ä–∞"\n`;
  response += `‚Ä¢ "–†–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ"\n\n`;

  response += `–ò–ª–∏ –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ –≤–æ–ø—Ä–æ—Å –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ! üòä`;

  return response;
}

// –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ —Ä–∞—Å—á–µ—Ç–∞
function tryCalculateLocally(text) {
  try {
    // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
    const hasBank = /\b(—Å–±–µ—Ä|–≤—Ç–±|–¥–æ–º\.—Ä—Ñ|–∞–ª—å—Ñ–∞|—Ç–∏–º–µ—Ä|–º–µ—Ç–∞–ª–ª|—Ä–æ—Å–±–∞–Ω–∫|—Ä–∞–π—Ñ—Ñ|–ø—Å–±|–∞–∫ –±–∞—Ä—Å|–∑–µ–Ω–∏—Ç|–∏—Ç–±|–º—Ç—Å|—É—Ä–∞–ª—Å–∏–±|—é–Ω–∏–∫—Ä–µ–¥–∏—Ç)\b/i.test(text);
    const hasAmount = /\b(\d[\d\s.,]{3,})\b/.test(text);
    const hasRisk = /\b(–∂–∏–∑–Ω—å|–∏–º—É—â–µ—Å—Ç–≤|—Ç–∏—Ç—É–ª)\b/i.test(text);

    if (hasBank && hasAmount && hasRisk) {
      return `üìä **–î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –Ω—É–∂–Ω—ã –ø–æ–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**

‚Ä¢ –ù–∞–∑–≤–∞–Ω–∏–µ –±–∞–Ω–∫–∞ (–°–±–µ—Ä–±–∞–Ω–∫, –í–¢–ë, –î–æ–º.–†–§ –∏ —Ç.–¥.)
‚Ä¢ –û–°–ó (–æ—Å—Ç–∞—Ç–æ–∫ —Å—Å—É–¥–Ω–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏)
‚Ä¢ –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –ø–æ–ª –∑–∞–µ–º—â–∏–∫–∞
‚Ä¢ –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞ (–∫–≤–∞—Ä—Ç–∏—Ä–∞/–¥–æ–º)

**–ü—Ä–∏–º–µ—Ä:** "–°–±–µ—Ä–±–∞–Ω–∫ –æ—Å–∑ 3000000 –º—É–∂ 15.08.1985 –∫–≤–∞—Ä—Ç–∏—Ä–∞"

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ!`;
    }

    return null;
  } catch (error) {
    return null;
  }
}

// –°—É–ø–µ—Ä-—É–º–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å Grok + –º–æ—â–Ω—ã–º –æ–±—É—á–∞–µ–º—ã–º –ø–∞—Ä—Å–µ—Ä–æ–º
async function chatWithGrok(message, conversationHistory = []) {
  const lowerMessage = message.toLowerCase().trim();

  // 1. –°–Ω–∞—á–∞–ª–∞ –ø—ã—Ç–∞–µ–º—Å—è –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –Ω–∞ —Ä–∞—Å—á–µ—Ç
  const calculationResult = tryCalculateFromText(message);
  if (calculationResult.isCalculation) {
    return {
      message: calculationResult.result,
      conversationHistory: [
        ...conversationHistory,
        { role: "user", content: message },
        { role: "assistant", content: calculationResult.result }
      ]
    };
  }

  // 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ä—É—é –±–∞–∑—É FAQ –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
  const faqResult = checkFAQ(lowerMessage);
  if (faqResult) {
    return {
      message: faqResult,
      conversationHistory: [
        ...conversationHistory,
        { role: "user", content: message },
        { role: "assistant", content: faqResult }
      ]
    };
  }

  // 3. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É–ø–µ—Ä-—É–º–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å –∞–Ω–∞–ª–∏–∑–æ–º
  const smartResponse = generateSuperSmartResponse(message);
  if (smartResponse && !smartResponse.includes('–Ø –ø–æ—Å—Ç–∞—Ä–∞–ª—Å—è –ø–æ–Ω—è—Ç—å')) {
    return {
      message: smartResponse,
      conversationHistory: [
        ...conversationHistory,
        { role: "user", content: message },
        { role: "assistant", content: smartResponse }
      ]
    };
  }

  // 4. –ï—Å–ª–∏ –ø–∞—Ä—Å–µ—Ä –Ω–µ —É–≤–µ—Ä–µ–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ–º Grok (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
  if (aiSettings.useGrok) {
    try {
      const grokResponse = await askGPTNeo(message);
      if (grokResponse && !grokResponse.includes('–û—à–∏–±–∫–∞') && !grokResponse.includes('–ò–∑–≤–∏–Ω–∏—Ç–µ')) {
        // –û–±—É—á–∞–µ–º—Å—è –æ—Ç –æ—Ç–≤–µ—Ç–∞ Grok
        if (aiSettings.learningMode) {
          learnFromResponse(message, grokResponse);
        }
        return {
          message: grokResponse,
          conversationHistory: [
            ...conversationHistory,
            { role: "user", content: message },
            { role: "assistant", content: grokResponse }
          ]
        };
      }
    } catch (error) {
      console.log('Grok –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–æ—â–Ω—ã–π –ø–∞—Ä—Å–µ—Ä:', error.message);
    }
  }

  // 5. –§–∏–Ω–∞–ª—å–Ω—ã–π fallback –Ω–∞ –º–æ—â–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
  const finalResponse = generateSmartFallback(message, analyzeQuestion(message));
  return {
    message: finalResponse,
    conversationHistory: [
      ...conversationHistory,
      { role: "user", content: message },
      { role: "assistant", content: finalResponse }
    ]
  };
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ø—ã—Ç–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –∏–∑ —Ç–µ–∫—Å—Ç–∞
function tryCalculateFromText(text) {
  try {
    // –ü–∞—Ä—Å–∏–º —Ç–µ–∫—Å—Ç –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
    const parsed = parseTextToObject(text);

    if (parsed.bank && parsed.osz && (parsed.risks.life || parsed.risks.property || parsed.risks.titul)) {
      const result = handleClientRequest(text);
      return {
        isCalculation: true,
        result: `–í–æ—Ç —Ä–∞—Å—á–µ—Ç –ø–æ –≤–∞—à–∏–º –¥–∞–Ω–Ω—ã–º:\n\n${result}`
      };
    }

    return { isCalculation: false };
  } catch (error) {
    return { isCalculation: false };
  }
}

// –ë–∞–∑–∞ –∑–Ω–∞–Ω–∏–π - —á–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã
function checkFAQ(question) {
  const faqs = {
    '–¥–æ–∫—É–º–µ–Ω—Ç—ã': `üìÑ **–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è:**

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã:**
‚Ä¢ –ü–∞—Å–ø–æ—Ä—Ç –∑–∞–µ–º—â–∏–∫–∞/—Å–æ–∑–∞–µ–º—â–∏–∫–æ–≤
‚Ä¢ –°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ –±—Ä–∞–∫–µ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏)
‚Ä¢ –°–≤–∏–¥–µ—Ç–µ–ª—å—Å—Ç–≤–æ –æ —Ä–æ–∂–¥–µ–Ω–∏–∏ –¥–µ—Ç–µ–π (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏)
‚Ä¢ –î–æ–≥–æ–≤–æ—Ä –∫—É–ø–ª–∏-–ø—Ä–æ–¥–∞–∂–∏ –∫–≤–∞—Ä—Ç–∏—Ä—ã/–¥–æ–º–∞
‚Ä¢ –í—ã–ø–∏—Å–∫–∞ –∏–∑ –ï–ì–†–ù
‚Ä¢ –û—Ç—á–µ—Ç –æ–± –æ—Ü–µ–Ω–∫–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏
‚Ä¢ –ö—Ä–µ–¥–∏—Ç–Ω—ã–π –¥–æ–≥–æ–≤–æ—Ä

**–î–ª—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è –∂–∏–∑–Ω–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
‚Ä¢ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞ (—Ñ–æ—Ä–º–∞ 086/—É)
‚Ä¢ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–æ–≤ (–ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é —Å—Ç—Ä–∞—Ö–æ–≤–æ–π)

**–î–ª—è —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è –∏–º—É—â–µ—Å—Ç–≤–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:**
‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ø–∞—Å–ø–æ—Ä—Ç –æ–±—ä–µ–∫—Ç–∞
‚Ä¢ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –æ–±—ä–µ–∫—Ç–∞`,

    '—Å–∫–∏–¥–∫–∏': `üí∞ **–°–∫–∏–¥–∫–∏ –Ω–∞ –∏–ø–æ—Ç–µ—á–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ:**

**–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–∏ (25% —Å–∫–∏–¥–∫–∞):**
‚Ä¢ –°–±–µ—Ä–±–∞–Ω–∫: ‚úì –¥–æ—Å—Ç—É–ø–Ω–∞
‚Ä¢ –í–¢–ë: ‚úì –¥–æ—Å—Ç—É–ø–Ω–∞
‚Ä¢ –î–æ–º.–†–§: ‚ùå –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞
‚Ä¢ –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫: ‚ùå –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞

**–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∏–º—É—â–µ—Å—Ç–≤–∞ (10% —Å–∫–∏–¥–∫–∞):**
‚Ä¢ –°–±–µ—Ä–±–∞–Ω–∫: ‚úì –¥–æ—Å—Ç—É–ø–Ω–∞
‚Ä¢ –í–¢–ë: ‚úì –¥–æ—Å—Ç—É–ø–Ω–∞
‚Ä¢ –î–æ–º.–†–§: ‚ùå –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞

**–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—É–º–º—ã –∫—Ä–µ–¥–∏—Ç–∞:**
‚Ä¢ –í–¢–ë: +10% –∫ –û–°–ó
‚Ä¢ –î–æ–º.–†–§: +0% –∫ –û–°–ó
‚Ä¢ –°–±–µ—Ä–±–∞–Ω–∫: +0% –∫ –û–°–ó`,

    '—Ä–∞–∑–Ω–∏—Ü–∞': `‚öñÔ∏è **–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É —Ç–∏–ø–∞–º–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è:**

**–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–∏ –∏ –∑–¥–æ—Ä–æ–≤—å—è:**
‚Ä¢ –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ—Ç–µ—Ä–∏ –¥–æ—Ö–æ–¥–∞ –ø—Ä–∏ –±–æ–ª–µ–∑–Ω–∏/–Ω–µ—Å—á–∞—Å—Ç–Ω–æ–º —Å–ª—É—á–∞–µ
‚Ä¢ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∏–ø–æ—Ç–µ–∫–∏ (—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –±–∞–Ω–∫–æ–≤)
‚Ä¢ –¢–∞—Ä–∏—Ñ—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏ –ø–æ–ª–∞
‚Ä¢ –°–∫–∏–¥–∫–∞ 25% –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –±–∞–Ω–∫–æ–≤

**–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∏–º—É—â–µ—Å—Ç–≤–∞:**
‚Ä¢ –ó–∞—â–∏—â–∞–µ—Ç –∫–≤–∞—Ä—Ç–∏—Ä—É/–¥–æ–º –æ—Ç –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π
‚Ä¢ –ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –±–∞–Ω–∫–∞–º–∏
‚Ä¢ –¢–∞—Ä–∏—Ñ—ã –∑–∞–≤–∏—Å—è—Ç –æ—Ç —Ç–∏–ø–∞ –æ–±—ä–µ–∫—Ç–∞
‚Ä¢ –°–∫–∏–¥–∫–∞ 10% –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ –±–∞–Ω–∫–æ–≤

**–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ —Ç–∏—Ç—É–ª–∞:**
‚Ä¢ –ó–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø–æ—Ç–µ—Ä–∏ –ø—Ä–∞–≤–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
‚Ä¢ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–∏ –ø–æ–∫—É–ø–∫–µ –≤—Ç–æ—Ä–∏—á–Ω–æ–≥–æ –∂–∏–ª—å—è
‚Ä¢ –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–∞—Ä–∏—Ñ 0,2%
‚Ä¢ –°–∫–∏–¥–∫–∏ –æ–±—ã—á–Ω–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è`,

    '–∫–æ–≥–¥–∞ –ø–ª–∞—Ç–∏—Ç—å': `üìÖ **–ö–æ–≥–¥–∞ –ø–ª–∞—Ç–∏—Ç—å –∑–∞ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ:**

**–ï–∂–µ–≥–æ–¥–Ω–∞—è –æ–ø–ª–∞—Ç–∞:**
‚Ä¢ –û–±—ã—á–Ω–æ –ø–ª–∞—Ç–µ–∂ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è —Ä–∞–∑ –≤ –≥–æ–¥
‚Ä¢ –ü–µ—Ä–≤—ã–π –ø–ª–∞—Ç–µ–∂ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫—Ä–µ–¥–∏—Ç–∞
‚Ä¢ –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ - –≤ –¥–∞—Ç—É –≤—ã–¥–∞—á–∏ –∫—Ä–µ–¥–∏—Ç–∞

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å –ø—Ä–∏ –ø—Ä–æ—Å—Ä–æ—á–∫–µ:**
‚Ä¢ –ë–∞–Ω–∫ –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç–Ω—É—é —Å—Ç–∞–≤–∫—É
‚Ä¢ –í —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö - —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –ø–æ–≥–∞—à–µ–Ω–∏—è
‚Ä¢ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ–ø–ª–∞—á–∏–≤–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ

**–í–æ–∑–≤—Ä–∞—Ç –ø—Ä–∏ –¥–æ—Å—Ä–æ—á–Ω–æ–º –ø–æ–≥–∞—à–µ–Ω–∏–∏:**
‚Ä¢ –í–æ–∑–≤—Ä–∞—Ç —á–∞—Å—Ç–∏ —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –ø—Ä–µ–º–∏–∏
‚Ä¢ –†–∞—Å—á–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –æ—Å—Ç–∞–≤—à–µ–º—É—Å—è —Å—Ä–æ–∫—É`,

    '–∫–∞–∫ —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å': `üí° **–ö–∞–∫ —Å—ç–∫–æ–Ω–æ–º–∏—Ç—å –Ω–∞ –∏–ø–æ—Ç–µ—á–Ω–æ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏:**

**1. –í—ã–±–æ—Ä –±–∞–Ω–∫–∞:**
‚Ä¢ –°–±–µ—Ä–±–∞–Ω–∫ –∏ –í–¢–ë –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Å–∫–∏–¥–∫–∏
‚Ä¢ –°—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Ä–∞–∑–Ω—ã—Ö —Å—Ç—Ä–∞—Ö–æ–≤—ã—Ö

**2. –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ:**
‚Ä¢ –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∂–∏–∑–Ω—å + –∏–º—É—â–µ—Å—Ç–≤–æ = —ç–∫–æ–Ω–æ–º–∏—è
‚Ä¢ –ü–∞–∫–µ—Ç–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –¥–µ—à–µ–≤–ª–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–∏—Å–æ–≤

**3. –ê–∫—Ü–∏–∏ –∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã:**
‚Ä¢ –õ—å–≥–æ—Ç–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –º–æ–ª–æ–¥—ã—Ö —Å–µ–º–µ–π
‚Ä¢ –°–∫–∏–¥–∫–∏ –∑–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å
‚Ä¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

**4. –°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ–ø–ª–∞—Ç–∞:**
‚Ä¢ –û–ø–ª–∞—Ç–∞ –∑–∞—Ä–∞–Ω–µ–µ = –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∫–∏–¥–∫–∏
‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–µ—à–µ–≤–ª–µ`,

    '–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ': `‚ùì **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –≤ –∏–ø–æ—Ç–µ–∫–µ:**

**–í—Å–µ–≥–¥–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
‚Ä¢ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∂–∏–∑–Ω–∏ –∏ –∑–¥–æ—Ä–æ–≤—å—è –∑–∞–µ–º—â–∏–∫–∞
‚Ä¢ –¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ –¶–ë –†–§ –∏ –±–∞–Ω–∫–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
‚Ä¢ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∏–º—É—â–µ—Å—Ç–≤–∞ (–∫–≤–∞—Ä—Ç–∏—Ä—ã/–¥–æ–º–∞)
‚Ä¢ –ë–∞–Ω–∫–∏ –º–æ–≥—É—Ç —É–≤–µ–ª–∏—á–∏—Ç—å —Å—Ç–∞–≤–∫—É –±–µ–∑ –Ω–µ–≥–æ

**–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
‚Ä¢ –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ —Ç–∏—Ç—É–ª–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤—Ç–æ—Ä–∏—á–∫–∏)
‚Ä¢ –õ–∏—á–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ —Å–æ–∑–∞–µ–º—â–∏–∫–æ–≤

**–®—Ç—Ä–∞—Ñ—ã –∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ:**
‚Ä¢ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–Ω–æ–π —Å—Ç–∞–≤–∫–∏ –Ω–∞ 0,5-2%
‚Ä¢ –í–æ–∑–º–æ–∂–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –ø–æ–≥–∞—à–µ–Ω–∏—è`
  };

  for (const [key, answer] of Object.entries(faqs)) {
    if (question.includes(key)) {
      return answer;
    }
  }

  return null;
}

// –£–º–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∑–∞–ø—Ä–æ—Å–∞
function generateSmartResponse(question) {
  // –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
  if (question.includes('—Å–∫–æ–ª—å–∫–æ') && (question.includes('–∂–∏–∑–Ω—å') || question.includes('–∏–º—É—â–µ—Å—Ç–≤–æ'))) {
    return `ü§î **–î–ª—è —Ç–æ—á–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞ –Ω—É–∂–Ω—ã –¥–∞–Ω–Ω—ã–µ:**

‚Ä¢ –ë–∞–Ω–∫-–∫—Ä–µ–¥–∏—Ç–æ—Ä (–°–±–µ—Ä–±–∞–Ω–∫, –í–¢–ë, –î–æ–º.–†–§ –∏ —Ç.–¥.)
‚Ä¢ –û—Å—Ç–∞—Ç–æ–∫ —Å—Å—É–¥–Ω–æ–π –∑–∞–¥–æ–ª–∂–µ–Ω–Ω–æ—Å—Ç–∏ (–û–°–ó)
‚Ä¢ –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –∏ –ø–æ–ª –∑–∞–µ–º—â–∏–∫–∞
‚Ä¢ –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞ (–∫–≤–∞—Ä—Ç–∏—Ä–∞/–¥–æ–º)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**
"–°–±–µ—Ä–±–∞–Ω–∫ –æ—Å–∑ 3000000 –º—É–∂ 15.08.1985 –∫–≤–∞—Ä—Ç–∏—Ä–∞"

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–∞–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ!`;
  }

  if (question.includes('–ª—É—á—à–∏–π') || question.includes('–≤—ã–±—Ä–∞—Ç—å')) {
    return `üéØ **–ö–∞–∫ –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ:**

**–§–∞–∫—Ç–æ—Ä—ã –≤—ã–±–æ—Ä–∞:**
1. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏** - —Ä–µ–π—Ç–∏–Ω–≥ –ê++/–ê+
2. **–°—Ç–æ–∏–º–æ—Å—Ç—å** - —Å—Ä–∞–≤–Ω–∏—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
3. **–£—Å–ª–æ–≤–∏—è** - –Ω–∞–ª–∏—á–∏–µ —Å–∫–∏–¥–æ–∫, —Ñ—Ä–∞–Ω—à–∏–∑–∞
4. **–°–µ—Ä–≤–∏—Å** - —Å–∫–æ—Ä–æ—Å—Ç—å —É—Ä–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏—è —É–±—ã—Ç–∫–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
‚Ä¢ –î–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏: –ò–Ω–≥–æ—Å—Å—Ç—Ä–∞—Ö, –†–æ—Å–≥–æ—Å—Å—Ç—Ä–∞—Ö, –°–æ–≥–ª–∞—Å–∏–µ
‚Ä¢ –î–ª—è —Ü–µ–Ω—ã: —Å—Ä–∞–≤–Ω–∏—Ç–µ 3-5 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π
‚Ä¢ –î–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏: –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏ —Å —Ö–æ—Ä–æ—à–∏–º–∏ –æ—Ç–∑—ã–≤–∞–º–∏

**–°–æ–≤–µ—Ç:** –ù–µ –≥–æ–Ω–∏—Ç–µ—Å—å –∑–∞ —Å–∞–º–æ–π –Ω–∏–∑–∫–æ–π —Ü–µ–Ω–æ–π - –∫–∞—á–µ—Å—Ç–≤–æ –≤–∞–∂–Ω–µ–µ!`;
  }

  if (question.includes('–ø—Ä–æ–¥–ª–∏—Ç—å') || question.includes('–ø—Ä–æ–¥–ª–µ–Ω–∏–µ')) {
    return `üîÑ **–ü—Ä–æ–¥–ª–µ–Ω–∏–µ –∏–ø–æ—Ç–µ—á–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è:**

**–ö–æ–≥–¥–∞ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å:**
‚Ä¢ –ó–∞ 30 –¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª–∏—Å–∞
‚Ä¢ –í –¥–∞—Ç—É –≤—ã–¥–∞—á–∏ –∫—Ä–µ–¥–∏—Ç–∞ (–µ–∂–µ–≥–æ–¥–Ω–æ)

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
‚Ä¢ –ó–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ
‚Ä¢ –ê–∫—Ç —Å–≤–µ—Ä–∫–∏ (–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤—ã–ø–ª–∞—Ç)
‚Ä¢ –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏—è:**
‚Ä¢ –°–∫–∏–¥–∫–∏ –∑–∞ –±–µ–∑—É–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å (–¥–æ 20%)
‚Ä¢ –ù–µ –Ω—É–∂–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –º–µ–¥–æ—Å–º–æ—Ç—Ä –∑–∞–Ω–æ–≤–æ
‚Ä¢ –ë–æ–ª–µ–µ –≤—ã–≥–æ–¥–Ω—ã–µ —É—Å–ª–æ–≤–∏—è

**–í–∞–∂–Ω–æ:** –ù–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ - –ø—Ä–æ—Å—Ä–æ—á–∫–∞ –º–æ–∂–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å —Å—Ç–∞–≤–∫—É!`;
  }

  if (question.includes('–≤—ã–ø–ª–∞—Ç–∞') || question.includes('—Å—Ç—Ä–∞—Ö–æ–≤–æ–π —Å–ª—É—á–∞–π')) {
    return `üö® **–°—Ç—Ä–∞—Ö–æ–≤–æ–π —Å–ª—É—á–∞–π –≤ –∏–ø–æ—Ç–µ–∫–µ:**

**–ü—Ä–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏ –∂–∏–∑–Ω–∏:**
‚Ä¢ –¢—è–∂–µ–ª–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ –∏–ª–∏ —Ç—Ä–∞–≤–º–∞
‚Ä¢ –ò–Ω–≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å 1-2 –≥—Ä—É–ø–ø—ã
‚Ä¢ –°–º–µ—Ä—Ç—å –∑–∞–µ–º—â–∏–∫–∞

**–ü—Ä–∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–∏ –∏–º—É—â–µ—Å—Ç–≤–∞:**
‚Ä¢ –ü–æ–∂–∞—Ä, –∑–∞—Ç–æ–ø–ª–µ–Ω–∏–µ, —Å—Ç–∏—Ö–∏–π–Ω—ã–µ –±–µ–¥—Å—Ç–≤–∏—è
‚Ä¢ –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
‚Ä¢ –ö—Ä–∞–∂–∞ –∏–º—É—â–µ—Å—Ç–≤–∞

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –ù–µ–∑–∞–º–µ–¥–ª–∏—Ç–µ–ª—å–Ω–æ —Å–æ–æ–±—â–∏—Ç—å –≤ —Å—Ç—Ä–∞—Ö–æ–≤—É—é
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ —Ñ–æ—Ç–æ
3. –ù–µ –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Ä–µ–º–æ–Ω—Ç –¥–æ –æ—Å–º–æ—Ç—Ä–∞
4. –ë–∞–Ω–∫ –ø–æ–ª—É—á–∏—Ç –≤—ã–ø–ª–∞—Ç—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–°—Ä–æ–∫–∏:** 20-30 –¥–Ω–µ–π –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–µ`;
  }

  return null;
}

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –≤ –≥–ª–æ–±–∞–ª—å–Ω—É—é –æ–±–ª–∞—Å—Ç—å
window.chatWithGrok = chatWithGrok;
window.askGPTNeo = askGPTNeo;
